(()=>{"use strict";var e,t,n,o,r={866:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{D9:()=>u,GO:()=>d,LO:()=>p,SJ:()=>l,Uc:()=>f,bY:()=>m,fG:()=>s});var r=n(497),a=n(734),c=e([r]);r=(c.then?(await c)():c)[0];var i="936197d7-9c28-4a02-b461-a2e30a81b6a7",s=function(e){return fetch(e,{headers:{authorization:i}}).then((function(t){return t.ok?(console.log("[GET] Успешно",t,e),t.json()):Promise.reject(t.status)})).catch((function(e){console.log("Ошибка в запросе GET: ".concat(e,"."))}))},u=function(e,t){fetch(t,{method:"PATCH",headers:{authorization:i,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(n){return n.ok?(console.log("[PATCH] Успешно",e,t,n),n.json()):Promise.reject("Что-то пошло не так: ".concat(n.status))})).catch((function(n){return console.log("Ошибка в запросе PATCH:",n,e,t),Promise.reject("Что-то пошло не так: ".concat(n))}))},l=function(e){return fetch(e,{method:"DELETE",headers:{authorization:i,"Content-Type":"application/json"}}).then((function(t){return t.ok?(console.log("[DELETE] Успешно",t,e),t.json()):Promise.reject("Что-то пошло не так: ".concat(t.status))})).catch((function(t){return console.log("Ошибка в запросе DELETE:",t,e),Promise.reject("Что-то пошло не так: ".concat(t))}))},d=function(e){var t=e.target.dataset.parentCardId,n=document.querySelector('[data-card-id="'.concat(t,'"]')),o=r.ZT+"/"+t;l(o).then((function(){n.remove(),(0,a.m)(a.$.deleteCardMessage)})).catch((function(e){console.log("Не удалось удалить карточку",e)}))},p=function(e,t){return fetch(t,{method:"POST",headers:{authorization:i,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(n){return n.ok?(console.log("[POST] Успешно",e,t),n.json()):Promise.reject("Что-то пошло не так: ".concat(n.status))})).catch((function(n){return console.log("Ошибка в запросе POST:",e,t,n),Promise.reject("Что-то пошло не так: ".concat(n))}))},f=function(e,t){return fetch(t,{method:"PUT",headers:{authorization:i,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(n){return n.ok?(console.log("[PUT] Успешно",e,t),n.json()):Promise.reject("Что-то пошло не так: ".concat(n.status))})).catch((function(n){return console.log("Ошибка в запросе PUT:",e,t,n),Promise.reject("Что-то пошло не так: ".concat(n))}))};function m(e,t){t.textContent=e?"Сохранение...":"Сохранить"}o()}catch(v){o(v)}}))},694:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{G:()=>d,z:()=>p});var r=n(497),a=n(866),c=n(734),i=n(756),s=e([r,a,i]);[r,a,i]=s.then?(await s)():s;var u=function(e){var t="https://nomoreparties.co/v1/".concat(r.$I,"/cards/likes/").concat(e);return(0,a.Uc)(r.m0,t).then((function(e){return console.log("Отправил лайк на сервер успешно",e),(0,c.m)(c.$.likeMessage),e})).catch((function(e){console.log("Отправил лайк на сервер, но что-то не так: ",e)}))},l=function(e){var t="https://nomoreparties.co/v1/".concat(r.$I,"/cards/likes/").concat(e);return(0,a.SJ)(t).then((function(e){return console.log("Лайк удалён",e),(0,c.m)(c.$.dislikeMessage),e})).catch((function(t){console.log("Ошибка при снятии лайка",t,e)}))};function d(e){var t=e.target,n=t.dataset.parentCardId,o=document.querySelector('[data-card-id="'.concat(n,'"]')),r=t.classList.contains("card__like-button_is-active");(r?l:u)(n).then((function(e){t.classList.toggle("card__like-button_is-active"),(0,i.Xg)(o,e)})).catch((function(e){console.log("Ошибка при ".concat(r?"снятии":"постановке"," лайка"),e)}))}function p(e,t,n,o){var a=document.querySelector("#card-template").content.querySelector(".places__item").cloneNode(!0),c=a.querySelector(".card__image"),s=a.querySelector(".card__title");if(a.querySelector(".card__likes"),c.src=e.link,c.alt=e.name,s.textContent=e.name,a.dataset.cardId=e._id,a.dataset.cardOwnerId=e.owner._id,(0,i.Xg)(a,e),a.dataset.cardOwnerId===r.m0._id){var u=a.querySelector(".card__delete-button");u.classList.add("card__delete-button-active"),u.dataset.parentCardId=a.dataset.cardId,u.addEventListener("click",o)}return c.addEventListener("click",(function(e){n(c)})),a.querySelector(".card__like-button").addEventListener("click",t),a}document.querySelector(".content").querySelector(".places__list"),o()}catch(f){o(f)}}))},947:(e,t,n)=>{function o(e){e.currentTarget===e.target&&a(document.querySelector(".popup_is-opened"))}function r(e){"Escape"===e.key&&a(document.querySelector(".popup_is-opened"))}function a(e){e.classList.remove("popup_is-opened"),window.removeEventListener("keyup",r),e.removeEventListener("click",o)}function c(e){e.classList.add("popup_is-opened"),window.addEventListener("keyup",r),e.addEventListener("click",o)}n.d(t,{O:()=>a,q:()=>c})},734:(e,t,n)=>{n.d(t,{$:()=>a,m:()=>r});var o=function(e){e.classList.contains("hidden")?(e.classList.remove("hidden"),setTimeout((function(){e.classList.remove("visually-hidden")}),20)):(e.classList.add("visually-hidden"),e.addEventListener("transitionend",(function(t){e.classList.add("hidden")}),{capture:!1,once:!0,passive:!1}))},r=function(e,t){var n=document.querySelector(".server-notification"),r=n.querySelector(".notification-title"),a=n.querySelector(".notification-message");r.textContent=e.title,a.textContent=e.text,o(n),setTimeout((function(){o(n)}),2e3)},a={likeMessage:{title:"Поймали ваш лайк!",text:"Он уже улетел на сервер"},dislikeMessage:{title:"Сняли ваш лайк!",text:"Иногда то, что раньше любил, может и разонравиться"},newCardMessage:{title:"Добавили новую карточку!",text:"Ну уж эта точно соберёт много лайков"},deleteCardMessage:{title:"Карточка удалена!",text:"Что делать с вашими карточками, решать только вам"},profileInfoUpdated:{title:"Инорфмация обновлена!",text:"Её уже видят другие участники проекта"},profileAvatarUpdated:{title:"Аватарка обновлена!",text:"Её уже видят другие участники проекта"}}},756:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{Xg:()=>d,g8:()=>l,kC:()=>u});var r=n(497),a=n(866),c=n(36),i=n(694),s=e([r,a,i]);[r,a,i]=s.then?(await s)():s;var u=function(){return(0,a.fG)(r.dx).then((function(e){r.Qn.textContent=e.name,r.mo.textContent=e.about,r.ZH.style.backgroundImage=(0,c.a)(e.avatar),r.JE.value=e.avatar,r.hz.value=e.name,r.Bl.value=e.about,console.log("Профиль, отрисован",e)})).catch((function(e){console.log("Не удалось отрисовать профиль",e)}))},l=function(){(0,a.fG)(r.ZT).then((function(e){e.sort((function(e,t){var n=e.likes.length,o=t.likes.length;return n>o?-1:n<o?1:0})).forEach((function(e){var t=(0,i.z)(e,i.G,r.NL,a.GO);r.dm.append(t)}))}))},d=function(e,t){var n=e.querySelector(".card__like-button"),o=e.querySelector(".card__likes");n.dataset.parentCardId=e.dataset.cardId,t.likes.length>0?(o.textContent=t.likes.length,o.classList.remove("no-likes")):(o.textContent=t.likes.length,o.classList.add("no-likes"));var a=t.likes.some((function(e){return e._id==r.m0._id}));n.classList.toggle("card__like-button_is-active",a)};o()}catch(e){o(e)}}))},878:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{R:()=>i,X:()=>s});var r=n(866),a=n(497),c=e([r,a]);[r,a]=c.then?(await c)():c;var i=function(e,t){var n={name:e,about:t};return(0,r.D9)(n,a.dx)},s=function(e){var t={avatar:e};return(0,r.D9)(t,a.mI)};o()}catch(e){o(e)}}))},36:(e,t,n)=>{n.d(t,{U:()=>r,a:()=>o});var o=function(e){return"url("+e+")"},r=function(e){return e.substring(5,e.length-2)}},547:(e,t,n)=>{n.d(t,{F:()=>a,R:()=>c});var o=function(e,t,n){t.classList.remove(n);var o=e.querySelector(".".concat(t.id,"-error"));o.classList.add("popup__input_transparent_text"),o.textContent=""};var r=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.classList.remove(n.inactiveButtonClass):t.classList.add(n.inactiveButtonClass)},a=function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);r(n,a,t),n.forEach((function(c){c.addEventListener("input",(function(){!function(e,t,n){!function(e){e.validity.patternMismatch?e.setCustomValidity(e.dataset.patternMismatchErrorMessage):e.setCustomValidity("")}(t),t.validity.valid?o(e,t,n.errorClass):function(e,t,n,o){t.classList.add(o);var r=e.querySelector(".".concat(t.id,"-error"));r.classList.remove("popup__input_transparent_text"),r.textContent=n}(e,t,t.validationMessage,n.errorClass)}(e,c,t),r(n,a,t)}))}))}(t,e)}))};function c(e,t,n){var a=e.querySelector(n.formSelector),c=Array.from(a.querySelectorAll(n.inputSelector));c.forEach((function(e){o(a,e,n.errorClass)})),r(c,t,n)}},497:(e,t,n)=>{n.a(e,(async(e,o)=>{try{n.d(t,{$I:()=>f,Bl:()=>T,JE:()=>J,NL:()=>H,Qn:()=>k,ZH:()=>R,ZT:()=>y,dm:()=>g,dx:()=>m,hz:()=>w,m0:()=>v,mI:()=>_,mo:()=>q});var r=n(947),a=n(694),c=n(36),i=n(547),s=n(756),u=n(878),l=n(866),d=n(734),p=e([a,s,u,l]);[a,s,u,l]=p.then?(await p)():p;var f="wff-cohort-21",m="https://nomoreparties.co/v1/".concat(f,"/users/me"),v=await(0,l.fG)(m),_="https://nomoreparties.co/v1/".concat(f,"/users/me/avatar"),y="https://nomoreparties.co/v1/".concat(f,"/cards"),h="https://nomoreparties.co/v1/".concat(f,"/cards"),S=document.querySelector(".content"),g=S.querySelector(".places__list"),b=S.querySelector(".profile__info"),k=b.querySelector(".profile__title"),q=b.querySelector(".profile__description"),L=S.querySelector(".profile__edit-button"),C=document.querySelector(".popup_type_edit"),E=C.querySelector(".popup__close"),x=document.forms["edit-profile"],w=x.elements.profile__title,T=x.elements.profile__description,I=x.querySelector("button");L.addEventListener("click",(function(e){(0,i.R)(C,I,Y),(0,r.q)(C),w.value=k.textContent,T.value=q.textContent})),x.addEventListener("submit",(function(e){e.preventDefault(),(0,l.bY)(!0,I),k.textContent=w.value,q.textContent=T.value,setTimeout((function(){(0,u.R)(w.value,T.value),console.log(u.X),(0,r.O)(C),(0,l.bY)(!1,I),(0,i.R)(C,I,Y)}),300)})),E.addEventListener("click",(function(e){(0,r.O)(C)}));var O=S.querySelector(".profile__add-button"),j=document.querySelector(".popup_type_new-card"),P=j.querySelector(".popup__close"),G=document.forms["new-place"],M=G.querySelector(".button"),A=G.elements["place-name"],z=G.elements.link;A.value="new card",z.value="https://i.postimg.cc/j5NsqWyG/temp-Image-NGHu-Mi.avif",O.addEventListener("click",(function(e){(0,r.q)(j)})),P.addEventListener("click",(function(e){(0,i.R)(j,M,Y),(0,r.O)(j)})),G.addEventListener("submit",(function(e){e.preventDefault(),(0,l.bY)(!0,M);var t={likes:[],createdAt:"",name:A.value,link:z.value,_id:"",owner:v},n=(0,a.z)(t,a.G,H,l.GO);(0,l.LO)(t,h).then((function(e){n.dataset.cardId=e._id,n.querySelector(".card__like-button").dataset.parentCardId=n.dataset.cardId,n.querySelector(".card__delete-button").dataset.parentCardId=n.dataset.cardId})),setTimeout((function(){(0,l.bY)(!1,M),(0,r.O)(j),G.reset(),g.prepend(n),(0,d.m)(d.$.newCardMessage)}),300),(0,i.R)(j,M,Y)}));var D=document.querySelector(".popup_type_image");function H(e){var t=D.querySelector(".popup__image"),n=D.querySelector(".popup__caption");t.src=e.src,t.alt=e.alt,n.textContent=e.alt,(0,r.q)(D)}D.querySelector(".popup__close").addEventListener("click",(function(e){(0,r.O)(D)}));var R=document.querySelector(".profile__image"),U=document.querySelector(".popup_type_profile-image-edit"),N=U.querySelector(".popup__close"),$=document.forms["edit-profile-image"],B=$.querySelector(".button"),J=$.elements["link-to-image"];R.addEventListener("click",(function(e){(0,i.R)(U,B,Y),(0,r.q)(U),J.value=(0,c.U)(R.style.backgroundImage)})),N.addEventListener("click",(function(e){(0,r.O)(U),(0,i.R)(U,B,Y)})),$.addEventListener("submit",(function(e){e.preventDefault(),(0,l.bY)(!0,B),setTimeout((function(){(0,l.bY)(!1,B),R.style.backgroundImage=(0,c.a)(J.value),(0,u.X)(J.value),(0,r.O)(U),(0,i.R)(U,B,Y)}),300)}));var Y={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};(0,i.F)(Y),(0,s.kC)(),(0,s.g8)(),o()}catch(X){o(X)}}),1)}},a={};function c(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return r[e](n,n.exports,c),n.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",o=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},c.a=(r,a,c)=>{var i;c&&((i=[]).d=-1);var s,u,l,d=new Set,p=r.exports,f=new Promise(((e,t)=>{l=t,u=e}));f[t]=p,f[e]=e=>(i&&e(i),d.forEach(e),f.catch((e=>{}))),r.exports=f,a((r=>{var a;s=(r=>r.map((r=>{if(null!==r&&"object"==typeof r){if(r[e])return r;if(r.then){var a=[];a.d=0,r.then((e=>{c[t]=e,o(a)}),(e=>{c[n]=e,o(a)}));var c={};return c[e]=e=>e(a),c}}var i={};return i[e]=e=>{},i[t]=r,i})))(r);var c=()=>s.map((e=>{if(e[n])throw e[n];return e[t]})),u=new Promise((t=>{(a=()=>t(c)).r=0;var n=e=>e!==i&&!d.has(e)&&(d.add(e),e&&!e.d&&(a.r++,e.push(a)));s.map((t=>t[e](n)))}));return a.r?u:c()}),(e=>(e?l(f[n]=e):u(p),o(i)))),i&&i.d<0&&(i.d=0)},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c(497)})();